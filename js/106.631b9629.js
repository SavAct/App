"use strict";(globalThis["webpackChunksavactapp"]=globalThis["webpackChunksavactapp"]||[]).push([[106],{49106:(e,o,n)=>{n.r(o),n.d(o,{default:()=>C});var t=n(61758),r=n(58790),a=n(29104);const i={id:"qrcam"},c={class:"q-pa-sm"},s={class:"row justify-center full-height full-width text-center","q-icon":"check_circle_outline"},l={class:"absolute-bottom info q-pa-sm"};function u(e,o,n,u,d,v){const g=(0,t.g2)("q-spinner"),f=(0,t.g2)("q-inner-loading"),h=(0,t.g2)("q-btn"),m=(0,t.g2)("q-icon"),p=(0,t.g2)("qrcode-stream"),w=(0,t.g2)("qrcode-capture"),R=(0,t.g2)("q-page");return(0,t.uX)(),(0,t.Wv)(R,{id:"qrpage",class:"items-center justify-evenly full-height full-width"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",i,[(0,t.bF)(f,{showing:e.loading},{default:(0,t.k6)((()=>[(0,t.bF)(g,{size:"40%",color:"primary"})])),_:1},8,["showing"]),(0,t.bF)(p,{class:"full-height full-width",torch:e.torchActive,paused:e.paused,onDetect:e.onDetect,onError:e.onError,constraints:e.constraints,onCameraOn:e.onInit},{default:(0,t.k6)((()=>[(0,t.Lk)("div",{class:(0,r.C4)(["full-height full-width",{confirmation:e.showScanConfirmation}])},[(0,t.Lk)("div",c,[(0,t.bF)(h,{onClick:e.switchCamera,round:"",icon:"flip_camera_ios",color:"gray"},null,8,["onClick"]),(0,t.bo)((0,t.bF)(h,{onClick:o[0]||(o[0]=o=>e.torchActive=!e.torchActive),class:(0,r.C4)(["self-end",e.torchActive?"text-blue":"text-white"]),round:"",icon:"flash_on"},null,8,["class"]),[[a.aG,e.torchSupported]])]),(0,t.bo)((0,t.Lk)("div",s,[(0,t.bF)(m,{name:"check_circle_outline",alt:"Checkmark",size:"128px",color:"green",class:"self-center"})],512),[[a.aG,e.showScanConfirmation]])],2)])),_:1},8,["torch","paused","onDetect","onError","constraints","onCameraOn"])]),(0,t.eW)(" Camera type: "+(0,r.v_)(e.constraints)+" ",1),(0,t.bo)((0,t.Lk)("div",l,[(0,t.Lk)("div",null,(0,r.v_)(e.errorMsg),1),(0,t.Lk)("div",null,(0,r.v_)(e.qrdata),1)],512),[[a.aG,e.errorMsg||e.qrdata]]),(0,t.Lk)("div",null,[o[1]||(o[1]=(0,t.Lk)("div",null,"Upload from file",-1)),(0,t.bF)(w,{onDecode:e.onDecode},null,8,["onDecode"])])])),_:1})}var d=n(38734),v=n(51500),g=n(60455),f=n(20989),h=function(e,o,n,t){function r(e){return e instanceof n?e:new n((function(o){o(e)}))}return new(n||(n=Promise))((function(n,a){function i(e){try{s(t.next(e))}catch(o){a(o)}}function c(e){try{s(t["throw"](e))}catch(o){a(o)}}function s(e){e.done?n(e.value):r(e.value).then(i,c)}s((t=t.apply(e,o||[])).next())}))};const m=(0,t.pM)({name:"page-qr-scanner",components:{QrcodeStream:v.tR,QrcodeCapture:v.Z3},setup(){const e=(0,g.rd)(),o=(0,d.KR)(""),n=(0,d.KR)(""),r=(0,d.KR)(null),a=(0,d.KR)(!1),i=(0,d.KR)(!1),c=(0,d.KR)({}),s=(0,d.KR)(!1),l=(0,d.KR)(!1),u=(0,d.KR)(!1),v=(0,d.KR)(!1),m=(0,d.KR)(16/9);function p(e){e.preventDefault(),console.log("is allowDrop")}function w(e){e.preventDefault(),console.log("dragged",e)}function R(e){return new Promise((o=>{window.setTimeout(o,e)}))}function b(e){return h(this,void 0,void 0,(function*(){n.value=e[0].rawValue,console.log("onDetect",e),i.value=!0,k(n.value),yield R(500),i.value=!1}))}function k(o){let n,t;if(o.startsWith("https://")?(t=o.substring(8),n=!0):o.startsWith("http://")?(t=o.substring(7),n=!0):(t=o,n=!1),t.startsWith("www.")&&(t=o.substring(4),n=!0),n&&t.startsWith("savact.app")){let o=t.indexOf("#")+1;if(o>0){console.log("link",t),console.log("s",o),console.log("s",t.substring(o));let n=t.substring(o);"/"!=n[0]&&(n="/"+n),console.log("QR Code go to:",n),e.push(n)}}}function E(e){return h(this,void 0,void 0,(function*(){console.log("onError",e),"NotAllowedError"===e.name?r.value="ERROR: you need to grant camera access permisson":"NotFoundError"===e.name?r.value="ERROR: no camera on this device":"NotSupportedError"===e.name?r.value="ERROR: secure context required (HTTPS, localhost)":"NotReadableError"===e.name?r.value="ERROR: is the camera already in use?":"OverconstrainedError"===e.name?r.value="ERROR: installed cameras are not suitable":"StreamApiNotSupportedError"===e.name&&(r.value="ERROR: Stream API is not supported in this browser"),f.A.create({message:"Camera error",caption:String(r.value),position:"top"})}))}function y(e){return h(this,void 0,void 0,(function*(){console.log("initData on QR Scanner Init",e),u.value=!!e.torch,e.height&&e.width&&(m.value=e.height.max/e.width.max,_()),s.value=i.value}))}function D(){switch(c.value.facingMode){case"front":c.value.facingMode="environment";break;case"rear":c.value.facingMode="user";break;default:c.value.facingMode="user"}}function q(e){e.preventDefault(),console.log("ondragover event",e)}function C(e){return h(this,void 0,void 0,(function*(){try{const{content:o}=yield e;n.value=o}catch(o){switch(console.log(o),o.name){case"DropImageFetchError":r.value="Sorry, you can't load cross-origin images :/";break;case"DropImageDecodeError":r.value="Sorry, you can't load cross-origin images :/";break;default:r.value=o.message;break}}}))}function S(e){console.log("Docode from file",e),n.value=e}function A(e){e.catch(console.error)}function _(){let e=document.getElementById("qrpage"),o=document.getElementById("qrcam");if(null!==o&&void 0!==(null===e||void 0===e?void 0:e.offsetWidth)&&void 0!==(null===e||void 0===e?void 0:e.offsetHeight)){let e=document.getElementsByTagName("header")[0],n=document.getElementsByTagName("footer")[0],t=e.offsetHeight+n.offsetHeight;o.style.maxWidth=window.innerHeight-t+"px"}}return(0,t.sV)((()=>{window.addEventListener("resize",_)})),(0,t.xo)((()=>{window.removeEventListener("resize",_)})),{code:o,qrdata:n,onDecode:S,onDetect:b,onInit:y,onError:E,errorMsg:r,loading:a,showScanConfirmation:s,paused:i,constraints:c,switchCamera:D,torchActive:l,torchSupported:u,dragover:v,onDragOver:q,onDetectDropZone:C,dropZoneErrors:A,allowDrop:p,drop:w}}});var p=n(12807),w=n(77716),R=n(39035),b=n(58210),k=n(56384),E=n(50492),y=n(98582),D=n.n(y);const q=(0,p.A)(m,[["render",u],["__scopeId","data-v-fa297266"]]),C=q;D()(m,"components",{QPage:w.A,QInnerLoading:R.A,QSpinner:b.A,QBtn:k.A,QIcon:E.A})}}]);