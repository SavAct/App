"use strict";(globalThis["webpackChunksavactapp"]=globalThis["webpackChunksavactapp"]||[]).push([[627],{55428:(e,t,o)=>{o.r(t),o.d(t,{default:()=>ve});var l=o(61758),a=o(58790);const n={class:"row justify-between reverse q-mt-md"},i={class:"col-12 col-sm-5 col-md-4 q-px-sm"},s={class:"row justify-between"},r={class:"q-pr-sm text-h6 q-mb-sm"},u={class:"col-12 text-h6 text-left"},c={class:"col-12 text-left"},d={class:"q-gutter-sm"},v={key:0,class:"q-mt-sm"},p={class:"col-12 col-sm-7 col-md-8 row justify-center"},m={class:"full-width"},b={class:"row"},g={class:"q-mb-sm col-grow q-pr-sm"},f={class:"col-auto"},h={key:0},y={class:"text-no-wrap"},k={class:"q-mb-md"},w={class:"full-width"},T={key:1},q={class:"full-width row flex-center q-gutter-sm"},V={class:"col q-pl-md"};function C(e,t,o,C,F,_){const x=(0,l.g2)("q-btn"),A=(0,l.g2)("q-btn-toggle"),R=(0,l.g2)("q-icon"),U=(0,l.g2)("q-card"),K=(0,l.g2)("bar-graph"),L=(0,l.g2)("pie-graph"),E=(0,l.g2)("vote-buttons"),S=(0,l.g2)("remaining-time"),W=(0,l.g2)("time-view"),I=(0,l.g2)("trx-tool-tip"),Q=(0,l.g2)("q-avatar"),D=(0,l.g2)("q-td"),z=(0,l.g2)("q-tr"),O=(0,l.g2)("q-table"),P=(0,l.g2)("symbol-dialog"),B=(0,l.g2)("q-card-section"),N=(0,l.g2)("q-card-actions"),X=(0,l.g2)("q-dialog"),M=(0,l.g2)("q-page"),j=(0,l.gN)("close-popup");return(0,l.uX)(),(0,l.Wv)(M,{class:"justify-evenly",style:{position:"relative",height:"100%"}},{default:(0,l.k6)((()=>[(0,l.Lk)("div",n,[(0,l.Lk)("div",i,[(0,l.bF)(U,{class:"card q-px-md q-pt-sm q-pb-md q-mb-md items-center"},{default:(0,l.k6)((()=>{var o,n;return[(0,l.Lk)("div",s,[(0,l.Lk)("div",r,(0,a.v_)(`${null===(n=null===(o=e.connect)||void 0===o?void 0:o.chainParams)||void 0===n?void 0:n.name} Network`),1),(0,l.bF)(x,{size:"sm",class:"row q-px-sm q-py-none q-mb-md",onClick:t[0]||(t[0]=t=>e.showSymbol=!0),outline:""},{default:(0,l.k6)((()=>[(0,l.Lk)("div",u,(0,a.v_)(e.symbol),1),(0,l.Lk)("div",c,(0,a.v_)(e.tokenContract),1)])),_:1})]),(0,l.Lk)("div",d,[(0,l.Lk)("div",null,(0,a.v_)(e.t("graphTypeBy"))+":",1),(0,l.bF)(A,{modelValue:e.switchCount,"onUpdate:modelValue":t[1]||(t[1]=t=>e.switchCount=t),class:"q-pa-none","no-caps":"",size:"sm",rounded:"",unelevated:"","toggle-color":"blue","text-color":"blue",style:{border:"1px solid #027be3"},options:[{label:e.t("fundingSum"),value:!1},{label:e.t("voteCount"),value:!0}]},null,8,["modelValue","options"]),(0,l.bF)(R,{class:"cursor-pointer",size:"sm",name:"info",onClick:t[2]||(t[2]=t=>e.infoDialog=!0),clickable:""})]),e.hasUserTrx?((0,l.uX)(),(0,l.CE)("div",v,[(0,l.Lk)("div",null,(0,a.v_)(e.t("voteFilter"))+":",1),(0,l.bF)(A,{disable:!e.hasUserTrx,modelValue:e.activeFilter,"onUpdate:modelValue":t[3]||(t[3]=t=>e.activeFilter=t),class:"q-mt-sm","no-caps":"",size:"sm",rounded:"",unelevated:"","toggle-color":"blue","text-color":"blue",style:{border:"1px solid #027be3"},options:[{label:e.t("allVotes"),value:!1},{label:e.t("activeVotes"),value:!0}]},null,8,["disable","modelValue","options"])])):(0,l.Q3)("",!0),(0,l.bF)(A,{class:"q-mt-md full-width",modelValue:e.chartType,"onUpdate:modelValue":t[4]||(t[4]=t=>e.chartType=t),"toggle-color":"blue",options:[{value:"bar90",slot:"bar90"},{value:"bar",slot:"bar"},{value:"pie",slot:"pie"},{value:"donut",slot:"donut"}]},{bar90:(0,l.k6)((()=>[(0,l.bF)(R,{name:"poll",style:{transform:"rotate(90deg)"}})])),bar:(0,l.k6)((()=>[(0,l.bF)(R,{name:"poll"})])),pie:(0,l.k6)((()=>[(0,l.bF)(R,{name:"pie_chart"})])),donut:(0,l.k6)((()=>[(0,l.bF)(R,{name:"data_usage"})])),_:1},8,["modelValue"])]})),_:1})]),(0,l.Lk)("div",p,["bar"==e.chartType||"bar90"==e.chartType?((0,l.uX)(),(0,l.Wv)(K,{class:"q-mx-sm",data:e.voteData,key:e.graphUpdateKey[0],switchCount:e.switchCount,symbol:e.symbol,precision:e.precision,horizontal:"bar90"==e.chartType},null,8,["data","switchCount","symbol","precision","horizontal"])):"pie"==e.chartType||"donut"==e.chartType?((0,l.uX)(),(0,l.Wv)(L,{class:"q-mx-sm",data:e.voteData,key:e.graphUpdateKey[1],switchCount:e.switchCount,symbol:e.symbol,precision:e.precision,donut:"donut"==e.chartType},null,8,["data","switchCount","symbol","precision","donut"])):(0,l.Q3)("",!0)])]),(0,l.bF)(O,{title:"Incomings",class:"q-mx-sm q-mb-md q-mt-sm card",rows:e.inRows,columns:e.inColumns,"row-key":e.rowKey,color:"amber",loading:e.loadingUpdateIn,"no-data-label":"Enter user accounts and click the update button to show data"},{top:(0,l.k6)((()=>[(0,l.Lk)("div",m,[(0,l.Lk)("div",b,[(0,l.Lk)("div",g,[(0,l.bF)(x,{icon:"bi-person",outline:"",round:"",size:"sm",onClick:t[5]||(t[5]=t=>e.showUser=!0)})]),(0,l.Lk)("div",f,[(0,l.bF)(E,{poll:e.pubVote,recipient:e.user,onShowResult:t[6]||(t[6]=t=>e.updateIn()),loading:e.loadingUpdateIn,"update-icon":"update"},null,8,["poll","recipient","loading"])])]),e.hasUserTrx?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[e.isVoteOver?void 0!==e.limit?((0,l.uX)(),(0,l.CE)("div",T,[(0,l.Lk)("span",null,(0,a.v_)(e.t("punishLimit"))+":  ",1),(0,l.bF)(S,{modelValue:e.limit,"onUpdate:modelValue":t[9]||(t[9]=t=>e.limit=t),timeOverMsg:e.t("voteResultTimeEnd"),onTimeover:t[10]||(t[10]=t=>e.isTimeover=!0)},null,8,["modelValue","timeOverMsg"])])):(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",h,[(0,l.Lk)("span",y,(0,a.v_)(e.t("voteEndTime")),1),(0,l.Lk)("span",k,[t[17]||(t[17]=(0,l.Lk)("span",null,":  ",-1)),(0,l.bF)(S,{modelValue:e.voteEnd,"onUpdate:modelValue":t[7]||(t[7]=t=>e.voteEnd=t),timeOverMsg:e.t("timeIsOver"),onTimeover:t[8]||(t[8]=t=>e.isVoteOver=!0)},null,8,["modelValue","timeOverMsg"])]),(0,l.Lk)("div",w,[(0,l.Lk)("span",null,(0,a.v_)(e.t("punishTimeSpanSend"))+":  ",1),(0,l.bF)(W,{class:"col",showTime:e.decisionTime,valueClasses:"text-green"},null,8,["showTime"])])]))],64)):(0,l.Q3)("",!0)])])),body:(0,l.k6)((o=>[(0,l.bF)(z,{props:o,class:(0,a.C4)(["cursor-pointer",o.row.removed?e.brightStyle?"bg-grey":"bg-grey-10":""]),onClick:t=>e.onRowClick(o.row,!0)},{default:(0,l.k6)((()=>[(0,l.bF)(I,{trx:o.row},null,8,["trx"]),(0,l.bF)(D,{key:"type",props:o},{default:(0,l.k6)((()=>[(0,l.bF)(Q,{"text-color":"black",size:"md",color:e.colorStatus(o.row.time),icon:0==o.row.type?"shopping_cart":"poll"},null,8,["color","icon"])])),_:2},1032,["props"]),(0,l.bF)(D,{key:"id",props:o},{default:(0,l.k6)((()=>[(0,l.eW)((0,a.v_)(o.row.id),1)])),_:2},1032,["props"]),(0,l.bF)(D,{key:"sender",props:o},{default:(0,l.k6)((()=>[(0,l.eW)((0,a.v_)(e.shortAddress(o.row.sender)),1)])),_:2},1032,["props"]),(0,l.bF)(D,{key:"fund",props:o},{default:(0,l.k6)((()=>[(0,l.eW)((0,a.v_)(o.row.orifund),1),t[18]||(t[18]=(0,l.Lk)("br",null,null,-1)),(0,l.eW)((0,a.v_)(o.row.contract),1)])),_:2},1032,["props"]),(0,l.bF)(D,{key:"vote",props:o,style:(0,a.Tr)(`color: ${e.VoteColor[o.row.vote.choice.selected]}`)},{default:(0,l.k6)((()=>[(0,l.eW)((0,a.v_)(o.row.vote?(o.row.vote.choice.selected+1).toString():""),1)])),_:2},1032,["props","style"]),(0,l.bF)(D,{key:"option",props:o},{default:(0,l.k6)((()=>{var t;return[(0,l.eW)((0,a.v_)(o.row.vote?e.shortenText(e.pubVote&&"object"===typeof e.pubVote.public?null===(t=e.pubVote.public.options[o.row.vote.choice.selected])||void 0===t?void 0:t.option:o.row.vote.choice.msg):o.row.memo),1)]})),_:2},1032,["props"])])),_:2},1032,["props","class","onClick"])])),"no-data":(0,l.k6)((({message:e})=>[(0,l.Lk)("div",q,[(0,l.Lk)("span",null,(0,a.v_)(e),1)])])),_:1},8,["rows","columns","row-key","loading"]),(0,l.bF)(P,{modelValue:e.showSymbol,"onUpdate:modelValue":t[11]||(t[11]=t=>e.showSymbol=t),contract:e.tokenContract,"onUpdate:contract":t[12]||(t[12]=t=>e.tokenContract=t),symbol:e.symbol,"onUpdate:symbol":t[13]||(t[13]=t=>e.symbol=t),connect:e.connect,precision:e.precision,"onUpdate:precision":t[14]||(t[14]=t=>e.precision=t)},null,8,["modelValue","contract","symbol","connect","precision"]),(0,l.bF)(X,{modelValue:e.infoDialog,"onUpdate:modelValue":t[15]||(t[15]=t=>e.infoDialog=t)},{default:(0,l.k6)((()=>[(0,l.bF)(U,{class:"card"},{default:(0,l.k6)((()=>[(0,l.bF)(B,{class:"q-pb-none row"},{default:(0,l.k6)((()=>[(0,l.bF)(R,{class:"col-auto",name:"info",size:"lg"}),(0,l.Lk)("span",V,(0,a.v_)(e.t("voteResultInfo")),1)])),_:1}),(0,l.bF)(N,{class:"q-pt-none",align:"right"},{default:(0,l.k6)((()=>[(0,l.bo)((0,l.bF)(x,{flat:"",label:"OK",color:"primary"},null,512),[[j]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.bF)(X,{modelValue:e.showUser,"onUpdate:modelValue":t[16]||(t[16]=t=>e.showUser=t)},{default:(0,l.k6)((()=>[(0,l.bF)(U,{class:"card"},{default:(0,l.k6)((()=>[(0,l.bF)(B,{class:"row"},{default:(0,l.k6)((()=>[(0,l.bF)(R,{class:"col-auto q-mr-sm",name:"bi-person",size:"md"}),(0,l.Lk)("div",{class:(0,a.C4)(["col-grow q-px-sm",e.user.length<=13?"text-h6":"text-subtitle2"])},(0,a.v_)(e.user),3)])),_:1}),(0,l.bF)(N,{class:"q-pt-none",align:"right"},{default:(0,l.k6)((()=>[(0,l.bo)((0,l.bF)(x,{flat:"",label:"Close",color:"primary"},null,512),[[j]])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}var F=o(38734),_=o(50697),x=o(3338),A=o(46162),R=o(85119),U=o(77489),K=o(64993),L=o(72836),E=o(57387),S=o(20989),W=o(39507),I=o(70308),Q=o(48960),D=o(72561),z=o(60455),O=o(75111),P=o(87639),B=o(87881),N=o(76847),X=o(32334),M=o(70954),j=function(e,t,o,l){function a(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,n){function i(e){try{r(l.next(e))}catch(t){n(t)}}function s(e){try{r(l["throw"](e))}catch(t){n(t)}}function r(e){e.done?o(e.value):a(e.value).then(i,s)}r((l=l.apply(e,t||[])).next())}))};const $=(0,l.pM)({name:"page-vote",components:{TrxToolTip:_["default"],PieGraph:x["default"],BarGraph:A["default"],SymbolDialog:R["default"],RemainingTime:U["default"],TimeView:K["default"],VoteButtons:L["default"]},setup(){const e=(0,P.J)(),t=(0,W.V)(),o=(0,E.s9)({useScope:"global"}).t.bind(this),a=(0,z.rd)(),n=(0,z.lq)(),i=n.query,s=(0,F.KR)("bar90"),r=(0,F.KR)(!1),u=(0,F.KR)(!1),c=(0,F.KR)(!1),d=(0,l.EW)({get:()=>c.value,set:e=>{c.value=e,u.value=!1}}),v=(0,F.KR)(!1),p=(0,F.KR)(!1),m=(0,F.KR)([0,0]),b=(0,F.KR)(!1),g=(0,F.KR)("SAVACT"),f=(0,F.KR)("token.savact"),h=(0,F.KR)(4),y=(0,B.GetConnectByChainId)(i.chain,t.allConnects),k=(0,F.KR)(!1),w=(0,F.KR)("string"==typeof i.to?i.to:t.historyUserInput?t.historyUserInput:""),T=(0,l.EW)({get:()=>w.value,set:e=>{w.value=e,((0,I.isNameValid)(e)||e.length>52&&Q.E.isValidPublic(e))&&t.setHistoryUserInput(e)}}),q=Number(i.id);function V(){var e;const o=null===(e=t.user[T.value])||void 0===e?void 0:e.inHistory.find((e=>0!=e.type&&e.id==q));if(!o)return;const l=(0,D.stringToAsset)(o.fund);f.value=o.contract,g.value=l.symbol.name,h.value=l.symbol.precision;const a=Date.now()/1e3;return o.time>a?d.value=!1:o.time>1&&(d.value=!0),o.vote&&o.vote.end>a?v.value=!1:o.time>1&&(v.value=!0),o}"number"!=typeof q&&console.log("Error: Missing id in query",q);const C=(0,F.KR)(V()),_=(0,l.EW)((()=>void 0!=C.value)),x=(0,l.EW)((()=>{if(C.value)return new Date(1e3*C.value.time)})),A=(0,l.EW)((()=>C.value&&C.value.vote?new Date(1e3*C.value.vote.end):void 0)),R=(0,l.EW)((()=>x.value&&A.value?(x.value.getTime()-A.value.getTime())/1e3:void 0)),U=(0,F.KR)(void 0);function K(){var e,o,l,a;return j(this,void 0,void 0,(function*(){if(yield ee(),C.value=V(),C.value&&2===(null===(o=null===(e=C.value)||void 0===e?void 0:e.vote)||void 0===o?void 0:o.type)&&void 0!==(null===(a=null===(l=C.value)||void 0===l?void 0:l.vote)||void 0===a?void 0:a.index)){J.value=!0;const e=C.value.vote,o=BigInt(C.value.vote.index);y&&(yield G.updatePublicVotes(y,o,o));const l=t.pubPolls.get(Number(o));if(l){const t=(0,D.stringToAsset)(C.value.fund).symbol;for(let o of l)o.id==e.id&&o.end==e.end&&o.symbol.name===t.name&&o.symbol.precision==t.precision&&o.chain==C.value.chain&&o.contract===C.value.contract&&o.options.length==e.total&&(U.value=o)}J.value=!1}}))}const L=(0,F.KR)(t.historyRecipientInput?t.historyRecipientInput:""),$=(0,l.EW)({get:()=>L.value,set:e=>{L.value=e,((0,I.isNameValid)(e)||e.length>52&&Q.E.isValidPublic(e))&&t.setHistoryRecipientInput(e)}}),H=(0,l.EW)((()=>e.brightStyle)),G=new M.TrxUpdater,J=(0,F.KR)(!1),Y=(0,F.KR)(!1),Z=(0,F.KR)(-1);function ee(){return j(this,void 0,void 0,(function*(){if(J.value)return;const e=T.value;e?J.value||(J.value=!0,y&&(yield G.updateAllIncomings(e,y)),J.value=!1):S.A.create({type:"negative",message:o("noSenderDefined"),caption:o("enterUserFirst"),position:"top"})}))}const te=(0,l.EW)((()=>[{name:"type",align:"left",label:"",field:"type"},{name:"id",align:"left",label:"Id",field:"id",sortable:!0},{name:"sender",align:"left",label:o("sender"),field:"sender",sortable:!0},{name:"fund",align:"left",label:o("fund"),field:"fund",sortable:!0},{name:"vote",align:"left",label:o("selection"),field:"vote"},{name:"option",align:"left",label:"Option",field:"option"}])),oe=(0,l.EW)((()=>t.user[T.value]&&_.value?t.user[T.value].inHistory.filter((e=>le(e))):[]));function le(e){if(C.value&&C.value.vote)return!(!e.vote||e.chain!=C.value.chain||e.contract!=C.value.contract||e.vote.id!=C.value.vote.id||e.vote.end!=C.value.vote.end||e.vote.total!=C.value.vote.total||e.vote.type!=C.value.vote.type||!(e.time==C.value.time||e.time<=1))}function ae(e,t){let o=t?{user:e.recipient,from:e.sender,id:e.id,chain:e.chain}:{user:e.sender,to:e.recipient,id:e.id,chain:e.chain};a.push({name:"action",query:o})}function ne(e){return`${e.sender} ${e.recipient} ${e.id}`}const ie=(0,l.EW)((()=>{if(C.value&&C.value.vote&&!(C.value.vote.total<=0)){if(r.value){let e=Array(C.value.vote.total).fill(0),t=new Set;for(let o of oe.value)if(o.vote&&!t.has(o.sender+o.vote.choice.selected)&&o.contract==f.value){const l=(0,D.stringToAsset)(o.fund);if(l.symbol.name==g.value&&l.symbol.precision==h.value){if(u.value&&o.time<=1)continue;e[o.vote.choice.selected]++,t.add(o.sender+o.vote.choice.selected)}}return e}{let e=Array(C.value.vote.total).fill(BigInt(0));for(let t of oe.value)if(t.contract==f.value){const o=(0,D.stringToAsset)(t.fund);if(o.symbol.name==g.value&&o.symbol.precision==h.value&&t.vote){if(u.value&&t.time<=1)continue;e[t.vote.choice.selected]+=o.amount}}return e.map((e=>Number(e)))}}}));return(0,l.sV)((()=>{K()})),{t:o,brightStyle:H,user:T,to:$,moreAvailable:Y,lastSearchId:Z,updateIn:ee,loadingUpdateIn:J,eosioStore:t,showWalletDialog:t.showWalletDialog,inColumns:te,inRows:oe,shortAddress:I.shortAddress,shortenText:I.shortenText,onRowClick:ae,rowKey:ne,colorStatus:O.colorStatus,showSymbol:b,connect:y,tokenContract:f,symbol:g,precision:h,voteData:ie,switchCount:r,graphUpdateKey:m,VoteColor:N.VoteColor,limit:x,activeFilter:u,isTimeover:d,isVoteOver:v,hasUserTrx:_,infoDialog:p,voteEnd:A,decisionTime:R,shrinkText:X.shrinkText,chartType:s,pubVote:U,showUser:k}}});var H=o(12807),G=o(77716),J=o(23316),Y=o(56384),Z=o(28975),ee=o(50492),te=o(9979),oe=o(44488),le=o(45262),ae=o(3952),ne=o(82156),ie=o(44189),se=o(62669),re=o(88672),ue=o(98582),ce=o.n(ue);const de=(0,H.A)($,[["render",C]]),ve=de;ce()($,"components",{QPage:G.A,QCard:J.A,QBtn:Y.A,QBtnToggle:Z.A,QIcon:ee.A,QTable:te.A,QTr:oe.A,QTd:le.A,QAvatar:ae.A,QDialog:ne.A,QCardSection:ie.A,QCardActions:se.A}),ce()($,"directives",{ClosePopup:re.A})}}]);