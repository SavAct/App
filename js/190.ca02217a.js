"use strict";(globalThis["webpackChunksavactapp"]=globalThis["webpackChunksavactapp"]||[]).push([[190],{2709:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Te});var i=a(61758),l=a(58790);const n={class:"row justify-between items-center"},o={key:0},s={key:0},r={class:"row q-mt-md"},c={class:"q-pr-sm col-auto f-td-width"},u={class:"row q-mt-sm"},d={class:"q-pr-sm col-auto f-td-width"},v={class:"row q-mt-md justify-left"},m={class:"col-grow"},g={class:"row q-mt-sm"},p={key:0,class:"f-td-width"},f={class:"text-bold"},y={key:0},b={key:0},h={class:"text-italic"},k={key:0,class:"row"},x={key:0,class:"f-td-width"},_={key:0,class:"row q-mt-sm"},w={class:"f-td-width"},S={key:1,class:"row q-mt-sm"},T={key:2,class:"row q-mt-sm"},C={class:"q-pr-sm col-auto f-td-width"},W={class:"col-grow",visible:!0},E={class:"no-wrap"},A={class:"row"},L={class:"full-width"},q={class:"row justify-between q-col-gutter-sm items-center"},P={key:0,class:"q-mt-md"},I={class:"text-bold"},V={key:1,class:"q-mt-md"},F={key:0},N={class:"text-no-wrap"},R={key:0},Q={key:1},X={key:2,class:"column"},j={key:3,class:"column"};function z(e,t,a,z,O,U){const $=(0,i.g2)("q-tooltip"),M=(0,i.g2)("q-chip"),K=(0,i.g2)("q-scroll-area"),B=(0,i.g2)("remaining-time"),D=(0,i.g2)("q-spinner-gears"),H=(0,i.g2)("q-inner-loading"),G=(0,i.g2)("q-card-section"),J=(0,i.g2)("q-card"),Y=(0,i.g2)("q-btn"),Z=(0,i.g2)("date-time-input"),ee=(0,i.g2)("key-or-name-input"),te=(0,i.g2)("manual-signer"),ae=(0,i.g2)("transfer-data-view"),ie=(0,i.g2)("q-page");return(0,i.uX)(),(0,i.Wv)(ie,{class:"column q-px-md q-pt-sm",style:{height:"100%"}},{default:(0,i.k6)((()=>[(0,i.bF)(J,{class:"card"},{default:(0,i.k6)((()=>[(0,i.bF)(G,null,{default:(0,i.k6)((()=>{var a,q,P,I,V;return[(0,i.Lk)("div",n,[e.statusText?((0,i.uX)(),(0,i.Wv)(M,{key:0,"text-color":"black",size:"md",color:e.statusColor,icon:0==e.type?"shopping_cart":"poll",clickable:!!e.vote,onClick:e.typeClick},{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(0==e.type?"Payment":"Vote")+" ",1),0!=e.type?((0,i.uX)(),(0,i.Wv)($,{key:0},{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(e.t("showVote")),1)])),_:1})):(0,i.Q3)("",!0)])),_:1},8,["color","icon","clickable","onClick"])):((0,i.uX)(),(0,i.Wv)(M,{key:1,"text-color":"black",size:"md",color:"white"},{default:(0,i.k6)((()=>t[12]||(t[12]=[(0,i.eW)((0,l.v_)("Unkown"))]))),_:1})),(0,i.bF)(M,{class:"bg-grey q-pa-sm"},{default:(0,i.k6)((()=>[e.statusText?((0,i.uX)(),(0,i.CE)("span",o,(0,l.v_)(e.statusText)+" - ",1)):(0,i.Q3)("",!0),(0,i.eW)(" Id: "+(0,l.v_)(e.id)+" ",1),(0,i.bF)($,null,{default:(0,i.k6)((()=>{var t;return[(0,i.eW)((0,l.v_)(e.t("localStorageDetails"))+": "+(0,l.v_)(e.t("usedNrIs"))+" "+(0,l.v_)(e.localNr)+" ",1),e.localReg?((0,i.uX)(),(0,i.CE)("span",s,(0,l.v_)(e.t("andFoundDateIs"))+" "+(0,l.v_)(null===(t=e.localReg)||void 0===t?void 0:t.toString()),1)):(0,i.Q3)("",!0)]})),_:1})])),_:1})]),(0,i.Lk)("div",r,[(0,i.Lk)("div",c,(0,l.v_)(e.t("recipient"))+":",1),(0,i.bF)(K,{class:"col-grow text-bold",visible:!0,style:{height:"35px"}},{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(e.to),1)])),_:1})]),(0,i.Lk)("div",u,[(0,i.Lk)("div",d,(0,l.v_)(e.t("sender"))+":",1),(0,i.bF)(K,{class:"col-grow text-bold",visible:!0,style:{height:"35px"}},{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(e.from),1)])),_:1})]),(0,i.Lk)("div",null,[(0,i.Lk)("div",v,[t[13]||(t[13]=(0,i.Lk)("div",{class:"f-td-width"},"Chain:",-1)),(0,i.Lk)("div",m,[(0,i.Lk)("div",null,(0,l.v_)(null===(a=e.chainParams)||void 0===a?void 0:a.name),1),(0,i.bF)(K,{class:"full-width",visible:!0,style:{height:"35px"}},{default:(0,i.k6)((()=>{var t;return[(0,i.eW)((0,l.v_)(null===(t=e.chainParams)||void 0===t?void 0:t.chainId),1)]})),_:1})])])]),(0,i.Lk)("div",null,[(0,i.Lk)("div",g,[e.fund.length>0?((0,i.uX)(),(0,i.CE)("div",p,(0,l.v_)(e.t("amount"))+":",1)):(0,i.Q3)("",!0),(0,i.Lk)("div",null,[(0,i.Lk)("span",f,(0,l.v_)(e.orifund),1),t[15]||(t[15]=(0,i.eW)()),e.fund!=e.orifund?((0,i.uX)(),(0,i.CE)("span",y,[(0,i.eW)("("+(0,l.v_)(e.fund),1),e.ramBy==(null===(q=e.chainParams)||void 0===q?void 0:q.savpayContract)?((0,i.uX)(),(0,i.CE)("span",b," + RAM")):(0,i.Q3)("",!0),t[14]||(t[14]=(0,i.eW)(")"))])):(0,i.Q3)("",!0),t[16]||(t[16]=(0,i.eW)()),(0,i.Lk)("span",h,(0,l.v_)(e.contract),1)])]),e.ramBy!=(null===(P=e.chainParams)||void 0===P?void 0:P.savpayContract)?((0,i.uX)(),(0,i.CE)("div",k,[e.ramBy.length>0?((0,i.uX)(),(0,i.CE)("div",x,"Ram by:")):(0,i.Q3)("",!0),(0,i.Lk)("div",null,(0,l.v_)(e.ramBy),1)])):(0,i.Q3)("",!0)]),e.time>1?((0,i.uX)(),(0,i.CE)("div",_,[(0,i.Lk)("div",w,(0,l.v_)(e.vote?e.t("voteTime"):e.t("timelimit"))+":",1),(0,i.Lk)("div",null,[(0,i.Lk)("div",null,(0,l.v_)(null===(I=e.timeDate)||void 0===I?void 0:I.toString()),1),e.removed?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.Wv)(B,{key:0,modelValue:e.timeDate,onTimeover:t[0]||(t[0]=t=>e.update())},null,8,["modelValue"]))])])):(0,i.Q3)("",!0),e.memo.length>0?((0,i.uX)(),(0,i.CE)("div",S,[t[17]||(t[17]=(0,i.Lk)("div",{class:"q-pr-sm col-auto f-td-width"},"Memo:",-1)),(0,i.bF)(K,{class:"col-grow",visible:!0,style:{height:"35px"}},{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(e.memo),1)])),_:1})])):(0,i.Q3)("",!0),e.vote?((0,i.uX)(),(0,i.CE)("div",T,[(0,i.Lk)("div",C,(0,l.v_)(e.t("vote"))+":",1),(0,i.Lk)("div",W,[(0,i.Lk)("div",E,[(0,i.eW)((0,l.v_)(e.t("selection"))+" ",1),(0,i.Lk)("span",{style:(0,l.Tr)(`color: ${e.VoteColor[e.vote.choice.selected]}`)},(0,l.v_)(e.vote.choice.selected+1),5),(0,i.eW)(" "+(0,l.v_)(e.t("of"))+" "+(0,l.v_)(e.vote.total)+" [ Id "+(0,l.v_)(e.vote.id)+" "+(0,l.v_)(void 0===e.vote.index?"":" / Public "+e.vote.index)+" ] ",1)]),(0,i.Lk)("div",A,[e.vote.choice.msg.length>0?((0,i.uX)(),(0,i.Wv)(K,{key:0,class:"col-grow text-italic",visible:!0,style:{height:"35px"}},{default:(0,i.k6)((()=>[(0,i.eW)('"'+(0,l.v_)(e.vote.choice.msg)+'"',1)])),_:1})):(0,i.Q3)("",!0)]),(0,i.Lk)("div",null,[(0,i.Lk)("div",L,(0,l.v_)(e.t("voteEndTime"))+":",1),(0,i.Lk)("div",null,(0,l.v_)(null===(V=e.voteEnd)||void 0===V?void 0:V.toString()),1),(0,i.bF)(B,{modelValue:e.voteEnd},null,8,["modelValue"])])])])):(0,i.Q3)("",!0),(0,i.bF)(H,{showing:e.loading},{default:(0,i.k6)((()=>[(0,i.bF)(D,{size:"50px",color:"primary"})])),_:1},8,["showing"])]})),_:1})])),_:1}),!e.removed&&e.statusText?((0,i.uX)(),(0,i.Wv)(J,{key:0,class:"q-my-sm card"},{default:(0,i.k6)((()=>[(0,i.bF)(G,null,{default:(0,i.k6)((()=>[(0,i.Lk)("div",q,[(0,i.Lk)("div",null,[(0,i.bF)(Y,{disable:"Active"!=e.statusText,icon:"task_alt",label:e.t("finalize"),class:"finalize-btn",onClick:t[1]||(t[1]=t=>e.tab="finalize"),color:"finalize"==e.tab?"blue":"","text-color":e.textColorStyle},null,8,["disable","label","color","text-color"])]),(0,i.Lk)("div",null,[(0,i.bF)(Y,{disable:"Active"!=e.statusText,icon:"whatshot",label:e.t("burn"),class:"inval-btn",onClick:t[2]||(t[2]=t=>e.tab="burn"),color:"burn"==e.tab?"red":"","text-color":e.textColorStyle},null,8,["disable","label","color","text-color"])]),(0,i.Lk)("div",null,[(0,i.bF)(Y,{disable:"Rejected"==e.statusText,icon:"reply_all",label:e.t("reject"),class:"reject-btn",onClick:t[3]||(t[3]=t=>e.tab="reject"),color:"reject"==e.tab?"orange":"","text-color":e.textColorStyle},null,8,["disable","label","color","text-color"])]),(0,i.Lk)("div",null,[(0,i.bF)(Y,{disable:"Active"!=e.statusText,icon:"more_time",label:e.t("extend"),class:"extend-btn",onClick:t[4]||(t[4]=t=>e.tab="extend"),color:"extend"==e.tab?"green":"","text-color":e.textColorStyle},null,8,["disable","label","color","text-color"])]),(0,i.Lk)("div",null,[(0,i.bF)(Y,{disable:"Active"==e.statusText,icon:"download",label:e.t("payoff"),class:"payoff-btn",onClick:t[5]||(t[5]=t=>{e.tab="payoff",e.payoffRecipient=e.getPayOffRecipientName}),color:"payoff"==e.tab?"grey":"","text-color":e.textColorStyle},null,8,["disable","label","color","text-color"])]),(0,i.Lk)("div",null,[(0,i.bF)(Y,{icon:"find_replace",class:"q-mx-sm",loading:e.loading,outline:"",onClick:t[6]||(t[6]=t=>e.update()),disable:e.loading,round:""},{default:(0,i.k6)((()=>[(0,i.bF)($,null,{default:(0,i.k6)((()=>[(0,i.eW)((0,l.v_)(e.t("update")),1)])),_:1})])),_:1},8,["loading","disable"])])]),e.infoActionText?((0,i.uX)(),(0,i.CE)("div",P,[(0,i.Lk)("span",I,(0,l.v_)(e.t("description"))+": ",1),(0,i.Lk)("span",null,(0,l.v_)(e.infoActionText),1)])):(0,i.Q3)("",!0)])),_:1})])),_:1})):((0,i.uX)(),(0,i.CE)("div",V,(0,l.v_)(e.t("altertTrx")),1)),""!=e.tab?((0,i.uX)(),(0,i.Wv)(J,{key:2,class:"card"},{default:(0,i.k6)((()=>[(0,i.bF)(G,null,{default:(0,i.k6)((()=>{var a,n;return["extend"==e.tab?((0,i.uX)(),(0,i.CE)("div",F,[(0,i.Lk)("div",null,[(0,i.Lk)("span",N,(0,l.v_)(e.t("timelimit")),1),void 0!==e.extendTime?((0,i.uX)(),(0,i.CE)("span",R,[t[18]||(t[18]=(0,i.Lk)("span",null,":  ",-1)),(0,i.bF)(B,{modelValue:e.extendTime,"onUpdate:modelValue":t[7]||(t[7]=t=>e.extendTime=t),timeOverMsg:e.t("timeIsOver")},null,8,["modelValue","timeOverMsg"])])):(0,i.Q3)("",!0)]),(0,i.bF)(Z,{class:"q-mb-sm",modelValue:e.extendTime,"onUpdate:modelValue":t[8]||(t[8]=t=>e.extendTime=t)},null,8,["modelValue"])])):"payoff"==e.tab?((0,i.uX)(),(0,i.CE)("div",Q,[(0,i.bF)(ee,{disable:e.getPayOffRecipientName.length>0,onlyName:"",modelValue:e.payoffRecipient,"onUpdate:modelValue":t[9]||(t[9]=t=>e.payoffRecipient=t),outlined:"",label:e.t("payoffAccount"),walletOption:"",class:"q-mb-md",connect:e.connect},null,8,["disable","modelValue","label","connect"])])):(0,i.Q3)("",!0),("finalize"==e.tab||"burn"==e.tab)&&!e.fromIsName||("reject"==e.tab||"extend"==e.tab)&&!e.toIsName||"payoff"==e.tab&&0==e.getPayOffRecipientName.length?((0,i.uX)(),(0,i.CE)("div",X,[(0,i.bF)(te,{massage:e.messageToSign,onSignature:t[10]||(t[10]=t=>e.signedMessage=t),onSigtime:t[11]||(t[11]=t=>e.lastSigTime=Math.round(t/1e3)),onSignclick:e.signClick},null,8,["massage","onSignclick"]),(null===(a=e.chainParams)||void 0===a?void 0:a.savpayContract)&&e.signedMessage?((0,i.uX)(),(0,i.Wv)(ae,{key:0,quantity:e.exchangeQuantityView,tokenContract:null===(n=e.chainParams.systemToken)||void 0===n?void 0:n.contract,recipient:e.chainParams.savpayContract,memo:e.memoMsg,memoActive:""},null,8,["quantity","tokenContract","recipient","memo"])):(0,i.Q3)("",!0),(0,i.bF)(Y,{disable:"string"!=typeof e.signedMessage||0==e.signedMessage.length,class:"q-mt-sm",label:"Send","icon-right":"send",onClick:e.send,color:e.tabColor},null,8,["disable","onClick","color"])])):((0,i.uX)(),(0,i.CE)("div",j,[(0,i.bF)(Y,{label:e.t("send"),"icon-right":"send",onClick:e.send,color:e.tabColor},null,8,["label","onClick","color"])]))]})),_:1})])),_:1})):(0,i.Q3)("",!0)])),_:1})}var O=a(48960),U=a(97687),$=a(20989),M=a(14907),K=a(87881),B=a(70308),D=a(65999),H=a(75111),G=a(39507),J=a(38734),Y=a(57387),Z=a(60455),ee=a(50619),te=a(53928),ae=a(77489),ie=a(98919),le=a(80080),ne=a(87639),oe=a(28744),se=a(72092),re=a(76847),ce=a(32334),ue=function(e,t,a,i){function l(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,n){function o(e){try{r(i.next(e))}catch(t){n(t)}}function s(e){try{r(i["throw"](e))}catch(t){n(t)}}function r(e){e.done?a(e.value):l(e.value).then(o,s)}r((i=i.apply(e,t||[])).next())}))};const de=(0,i.pM)({name:"page-trx-action",components:{ManualSigner:ee["default"],DateTimeInput:te["default"],RemainingTime:ae["default"],KeyOrNameInput:ie["default"],TransferDataView:le["default"]},setup(){var e,t;const a=(0,M.A)(),l=(0,G.V)(),n=(0,Z.lq)(),o=(0,Z.rd)(),s=(0,Y.s9)({useScope:"global"}).t.bind(this),r=(0,J.KR)(""),c=(0,J.KR)(0),u=(0,i.EW)((()=>{if(!fe.value)return"";const e=(0,D.base58Time)(ye.value),t=(0,D.base58Time)(k);switch(r.value){case"finalize":return`FIN@${g}#${t}=${e}~${fe.value}`;case"burn":return`INV@${g}#${t}=${e}~${fe.value}`;case"reject":return`REJ@${g}#${t}=${e}~${fe.value}`;case"extend":if(!c.value||c.value<Date.now()/1e3)return"";const a=(0,D.base58Time)(c.value);return`EXT@${g}#${t}!${a}=${e}~${fe.value}`;case"payoff":return"string"==typeof pe.value||(0,B.isNameValid)(pe.value)?`OFF@${g}#${t}=${e}~${fe.value}+${pe.value}`:"";default:return""}})),d=(0,ne.J)(),v=n.query;console.log("Transaction query",v);let m=v.user;m&&m.length>13&&(m=U.PublicKey.fromString(m).toString());let g=v.to?v.to:m,p=v.from?v.from:m;const f=p==m,y=g==m,b=(0,K.GetConnectByChainId)(v.chain,l.allConnects);b||($.A.create({type:"negative",message:s("noChainDefined"),position:"top"}),o.replace({name:"404"}));const h=(0,i.EW)((()=>null===b||void 0===b?void 0:b.chainParams)),k=Number(v.id);let x=(0,J.KR)();g==m?x.value=null===(e=l.user[m])||void 0===e?void 0:e.inHistory.find((e=>{var t,a;return e.id==k&&(e.chain==(null===(t=h.value)||void 0===t?void 0:t.chainId)||e.chain==(null===(a=h.value)||void 0===a?void 0:a.shortName))})):p==m&&(x.value=null===(t=l.user[m])||void 0===t?void 0:t.outHistory.find((e=>{var t,a;return e.id==k&&e.recipient==g&&(e.chain==(null===(t=h.value)||void 0===t?void 0:t.chainId)||e.chain==(null===(a=h.value)||void 0===a?void 0:a.shortName))})));const _=(0,J.KR)(!1),w=(0,i.EW)((()=>x.value?x.value.fund:"")),S=(0,i.EW)((()=>x.value?x.value.orifund:"")),T=(0,i.EW)((()=>x.value?x.value.contract:"")),C=(0,i.EW)((()=>x.value?(0,ce.StringToUtf8String)(x.value.memo):"")),W=(0,i.EW)((()=>x.value?x.value.vote:"")),E=(0,i.EW)((()=>W.value?new Date(1e3*W.value.end):void 0)),A=(0,i.EW)((()=>x.value?x.value.ramBy:"")),L=(0,i.EW)((()=>x.value?x.value.time:-2)),q=(0,i.EW)((()=>L.value?new Date(1e3*L.value):void 0)),P=(0,i.EW)((()=>x.value?x.value.type:-1)),I=(0,i.EW)((()=>!!x.value&&x.value.removed)),V=(0,i.EW)((()=>x.value&&x.value.nr?String(x.value.nr):"")),F=(0,i.EW)((()=>x.value&&x.value.firstReg?new Date(x.value.firstReg):void 0));let N,R;if((0,B.isNameValid)(p))N=(0,D.nameToFromHex)(p);else if(O.E.isValidPublic(p)){const e=U.PublicKey.fromString(p);N=(0,D.hexWithTypeOfPubKey)(e),p=e.toString()}else $.A.create({type:"negative",message:p.length<13?s("invalidAcc"):s("invalidPub"),position:"top"}),o.replace({name:"404"});if((0,B.isNameValid)(g))R=g;else if(O.E.isValidPublic(g)){const e=U.PublicKey.fromString(g);R=(0,D.splitPubKeyToScopeAndTableVec)(e),g=e.toString()}else $.A.create({type:"negative",message:g.length<13?s("invalidAcc"):s("invalidPub"),position:"top"}),o.replace({name:"404"});function Q(){return ue(this,void 0,void 0,(function*(){r.value="";try{console.log("current connect",b),_.value=!0;const e=Date.now(),t="string"==typeof R?ce.SavActPayTableType.pay2name:ce.SavActPayTableType.pay2key,a={code:null===b||void 0===b?void 0:b.chainParams.savpayContract,table:t==ce.SavActPayTableType.pay2name?"pay2name":"pay2key",scope:"string"==typeof R?R:String(R.scope),lower_bound:String(k),upper_bound:String(k),json:!1},i=yield null===b||void 0===b?void 0:b.get_table_rows(a),n=()=>{if(!h.value)return console.log("Undefined chain parameters"),!1;if("rows"in i){if(i.rows.length>0){if("string"!=typeof i.rows[0]&&i.rows[0].length>0)return $.A.create({type:"negative",message:s("entrynotexist"),caption:s("isdatacorrect"),position:"top"}),!1;const a=(0,ce.rawSavActPaymentToObject)(i.rows[0],t);if(void 0===a||void 0!==a.to&&"string"!==typeof R&&R.tableVec!=a.to)return $.A.create({type:"negative",message:s("entrynotexist"),caption:s("isdatacorrect"),position:"top"}),!1;if(N!=a.from)return $.A.create({type:"negative",message:s("wrongsender"),position:"top"}),!1;const n=a.fund.symbol;if(void 0==n)return $.A.create({type:"negative",message:s("errReadSymbol"),position:"top"}),!1;if(!m){const t={sender:p,recipient:g,id:Number(a.id),fund:(0,B.AssetToString)(a.fund),orifund:(0,B.AssetToString)({amount:a.orisent,symbol:n}),memo:a.memo,ramBy:a.ramBy,type:a.type,time:a.time,contract:a.contract,lastUpdate:e,removed:!1,chain:h.value.shortName?h.value.shortName:h.value.chainId};x.value=t}if(m==g){const t={sender:p,recipient:m,id:Number(a.id),fund:(0,B.AssetToString)(a.fund),orifund:(0,B.AssetToString)({amount:a.orisent,symbol:n}),memo:a.memo,ramBy:a.ramBy,type:a.type,time:a.time,contract:a.contract,lastUpdate:e,removed:!1,chain:h.value.shortName?h.value.shortName:h.value.chainId};l.updateHistoryInTrx(m,t),x.value=t}if(m==p){const t={sender:m,recipient:g,id:Number(a.id),fund:(0,B.AssetToString)(a.fund),orifund:(0,B.AssetToString)({amount:a.orisent,symbol:n}),memo:a.memo,ramBy:a.ramBy,type:a.type,time:a.time,contract:a.contract,lastUpdate:e,removed:!1,chain:h.value.shortName?h.value.shortName:h.value.chainId};l.updateHistoryOutTrx(m,t),x.value=t}}else x.value&&(x.value.removed=!0,m==g&&l.updateHistoryInTrx(m,x.value),m==p&&l.updateHistoryOutTrx(m,x.value));return!0}return $.A.create({type:"negative",message:s("entrynotexist"),caption:s("isdatacorrect"),position:"top"}),!1};n()}catch(e){console.log("Error on requesting data",e)}finally{_.value=!1}}))}const X=(0,i.EW)((()=>(0,H.colorStatus)(L.value))),j=(0,i.EW)((()=>(0,H.textStatus)(L.value,I.value)));function z(e,t,a){return ue(this,void 0,void 0,(function*(){if(!b||"string"!=typeof b.chainParams.savpayContract)return;if(l.setSelectedConnect(b),!l.walletUser){$.A.create({message:s("errSelectWallet"),position:"top"});const e={chainId:b.chainParams.chainId,show:!0};return void l.setWalletDialog(e)}const i=[{actor:t,permission:l.walletUser.permission?l.walletUser.permission:"active"}],n={actions:[{account:b.chainParams.savpayContract,name:e,authorization:i,data:a}]},o=$.A.create({type:"ongoing",message:s("signTrx"),position:"top"}),r={isError:!1,notify:o},c=yield K.Connect.trySigning(r,l.walletUser,n,{broadcast:!1});return!!(0,se.trxSigningErrorHandling)(r,c,s)&&(!!(yield(0,se.broadcastTrx)(r,b,c,s))&&(setTimeout(Q,5e3),!0))}))}function ee(){m==g&&l.updateHistoryInTrx(m,x.value),m==p&&l.updateHistoryOutTrx(m,x.value)}function te(){a.dialog({title:s("finalize"),message:s("finalize_dialog"),options:{type:"checkbox",model:[],isValid:e=>e.includes("opt1"),items:[{label:s("action_check"),value:"opt1"}]},cancel:s("cancel"),ok:s("confirm"),persistent:!0}).onOk((e=>ue(this,void 0,void 0,(function*(){var t,a;let i;console.log("Send finalize",e),i=ve.value?yield z("finalize",ve.value?p:String(null===(t=l.walletUser)||void 0===t?void 0:t.name),{to:g,id:k}):yield z("finalizesig",String(null===(a=l.walletUser)||void 0===a?void 0:a.name),{to:g,id:k,sigtime:ye.value,sig:fe.value}),i&&x.value&&(x.value.time=1,ee())}))))}function ae(){a.dialog({title:s("burn"),message:s("burn_dialog"),options:{type:"checkbox",model:[],isValid:e=>e.includes("opt1"),items:[{label:s("action_check"),value:"opt1"}]},cancel:s("cancel"),ok:s("confirm"),persistent:!0}).onOk((e=>ue(this,void 0,void 0,(function*(){var t,a;let i;console.log("Send burn",e),i=ve.value?yield z("invalidate",ve.value?p:String(null===(t=l.walletUser)||void 0===t?void 0:t.name),{to:g,id:k}):yield z("invalisig",String(null===(a=l.walletUser)||void 0===a?void 0:a.name),{to:g,id:k,sigtime:ye.value,sig:fe.value}),i&&x.value&&(x.value.time=-1,ee())}))))}function ie(){a.dialog({title:s("reject"),message:s("reject_dialog"),options:{type:"checkbox",model:[],isValid:e=>e.includes("opt1"),items:[{label:s("action_check"),value:"opt1"}]},cancel:s("cancel"),ok:s("confirm"),persistent:!0}).onOk((e=>ue(this,void 0,void 0,(function*(){var t,a;let i;console.log("Send reject",e),i=me.value?yield z("reject",me.value?g:String(null===(t=l.walletUser)||void 0===t?void 0:t.name),{to:g,id:k}):yield z("rejectsig",String(null===(a=l.walletUser)||void 0===a?void 0:a.name),{to:g,id:k,sigtime:ye.value,sig:fe.value}),i&&x.value&&(x.value.time=0,ee())}))))}function le(){a.dialog({title:s("extend"),message:s("extend_dialog"),options:{type:"checkbox",model:[],isValid:e=>e.includes("opt1"),items:[{label:s("action_check"),value:"opt1"}]},cancel:s("cancel"),ok:s("confirm"),persistent:!0}).onOk((e=>ue(this,void 0,void 0,(function*(){var t,a;if(console.log("Send extend",e),!ge.value)return;const i=Math.round(ge.value.getTime()/1e3);let n;n=me.value?yield z("extend",me.value?g:String(null===(t=l.walletUser)||void 0===t?void 0:t.name),{to:g,id:k,time:i}):yield z("extendsig",String(null===(a=l.walletUser)||void 0===a?void 0:a.name),{to:g,id:k,time:i,sigtime:ye.value,sig:fe.value}),n&&x.value&&(x.value.time=i,ee())}))))}function de(){a.dialog({title:s("payoff"),message:s("payoff_dialog"),options:{type:"checkbox",model:[],isValid:e=>e.includes("opt1"),items:[{label:s("action_check"),value:"opt1"}]},cancel:s("cancel"),ok:s("confirm"),persistent:!0}).onOk((e=>ue(this,void 0,void 0,(function*(){var t,a;console.log("Send payoff",e),Te.value.length>0?yield z("payoff",String(null===(t=l.walletUser)||void 0===t?void 0:t.name),{to:g,id:k}):yield z("payoffsig",String(null===(a=l.walletUser)||void 0===a?void 0:a.name),{to:g,id:k,recipient:pe.value,sigtime:ye.value,sig:fe.value})}))))}const ve=(0,i.EW)((()=>p.length<=13)),me=(0,i.EW)((()=>g.length<=13)),ge=(0,J.KR)(),pe=(0,J.KR)(""),fe=(0,J.KR)(""),ye=(0,J.KR)(-1),be=(0,J.KR)({});function he(){switch(r.value){case"finalize":te();break;case"burn":ae();break;case"reject":ie();break;case"extend":le();break;case"payoff":de();break;default:return}}const ke=(0,i.EW)((()=>{switch(r.value){case"finalize":return s("finalize_dialog_short");case"burn":return s("burn_dialog_short");case"reject":return s("reject_dialog");case"extend":return s("extend_dialog");case"payoff":return s("payoff_dialog");default:return""}})),xe=(0,i.EW)((()=>d.brightStyle?"black":"white"));function _e(){return ue(this,void 0,void 0,(function*(){be.value=yield(()=>ue(this,void 0,void 0,(function*(){if(!h.value||void 0==h.value.savpayContract)return{};const e=Date.now(),t=String(Math.round(e/1e3));switch(r.value){case"finalize":return{msg:(0,oe.finalizeMsg)(h.value.chainId,h.value.savpayContract,g,String(k),t),time:e};case"burn":return{msg:(0,oe.invalidateMsg)(h.value.chainId,h.value.savpayContract,g,String(k),t),time:e};case"reject":let a;if(ve.value)a=p;else{const e=U.PublicKey.fromString(p);a=(0,D.hexWithTypeOfPubKey)(e)}return{msg:(0,oe.rejectMsg)(h.value.chainId,h.value.savpayContract,a,String(k),t),time:e};case"extend":if(!ge.value)return{};const i=U.PublicKey.fromString(g),l=(0,D.hexWithTypeOfPubKey)(i);return c.value=Math.round(ge.value.getTime()/1e3),{msg:(0,oe.extendMsg)(h.value.chainId,h.value.savpayContract,String(c.value),l,String(k),t),time:e};case"payoff":return"string"!=typeof pe.value?($.A.create({type:"negative",message:s("enterName"),position:"top"}),{}):{msg:(0,oe.payOffMsg)(h.value.chainId,h.value.savpayContract,g,pe.value,String(k),t),time:e};default:return{}}})))()}))}const we=(0,i.EW)((()=>{var e;return(null===(e=h.value)||void 0===e?void 0:e.systemToken)?(0,B.AssetToString)({amount:BigInt(1),symbol:{name:h.value.systemToken.symbol,precision:h.value.systemToken.precision}}):""})),Se=(0,i.EW)((()=>{switch(j.value){case"Active":return;case"Finalized":return g;case"Rejected":return p;default:return}})),Te=(0,i.EW)((()=>Se.value&&Se.value.length<=13?Se.value:"")),Ce=(0,i.EW)((()=>{switch(r.value){case"burn":return"red";case"finalize":return"blue";case"reject":return"orange";case"extend":return"green";case"payoff":return"grey";default:return""}}));function We(){W.value&&o.push({name:"vote-result",query:{to:g,id:v.id,chain:v.chain}})}return Q(),{t:s,textColorStyle:xe,update:Q,loading:_,id:k,to:g,from:p,fund:w,orifund:S,contract:T,time:L,timeDate:q,memo:C,vote:W,ramBy:A,type:P,removed:I,localNr:V,localReg:F,userIsSender:f,userIsRecipient:y,chainParams:h,statusColor:X,statusText:j,finalize:te,burn:ae,reject:ie,payoff:de,tab:r,fromIsName:ve,toIsName:me,signedMessage:fe,send:he,infoActionText:ke,payoffRecipient:pe,extendTime:ge,connect:b,messageToSign:be,lastSigTime:ye,signClick:_e,memoMsg:u,exchangeQuantityView:we,getPayOffRecipientName:Te,tabColor:Ce,typeClick:We,VoteColor:re.VoteColor,voteEnd:E}}});var ve=a(12807),me=a(77716),ge=a(23316),pe=a(44189),fe=a(66760),ye=a(97410),be=a(48958),he=a(39035),ke=a(85792),xe=a(56384),_e=a(98582),we=a.n(_e);const Se=(0,ve.A)(de,[["render",z],["__scopeId","data-v-a762339a"]]),Te=Se;we()(de,"components",{QPage:me.A,QCard:ge.A,QCardSection:pe.A,QChip:fe.A,QTooltip:ye.A,QScrollArea:be.A,QInnerLoading:he.A,QSpinnerGears:ke.A,QBtn:xe.A})}}]);